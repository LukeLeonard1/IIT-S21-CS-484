# -*- coding: utf-8 -*-
"""
Created on Sun May  1 19:16:46 2021

@author: Sukanta
"""

# Importig Libraries
import matplotlib.pyplot as plt
import numpy
import pandas
import sklearn.ensemble as ensemble
import sklearn.tree as tree
import sklearn.metrics as metrics
import graphviz

# -------------------------------

# global variables
SPLITTING_CRITERION = 'entropy'
MAXIMUM_TREE_DEPTH = 5
INIT_RNDM_SEED = 20210415
MAX_BOOSTING_ITR = 50
INTERRUPT_ACCURACY = 0.9999999
INPUT_FEATURES = ['alcohol', 'citric_acid', 'free_sulfur_dioxide', 'residual_sugar', 'sulphates']
TARGET_FEATURE = ['quality_grp']
# -------------------------------

# Read Data
trainData = pandas.read_csv('WineQuality_Train.csv')
testData = pandas.read_csv('WineQuality_Test.csv')
# -------------------------------
nObs = trainData.shape[0]

x_train = trainData[INPUT_FEATURES]
y_train = trainData[TARGET_FEATURE]

x_test = trainData[INPUT_FEATURES]
y_test = trainData[TARGET_FEATURE]
# q1.a -------------------------------
classTree = tree.DecisionTreeClassifier(
    criterion=SPLITTING_CRITERION
    , max_depth=MAXIMUM_TREE_DEPTH
    , random_state=INIT_RNDM_SEED)
treeFit = classTree.fit(x_train, y_train)
treePredProb = classTree.predict_proba(x_train)
accuracy = classTree.score(x_train, y_train)
print('Misclassification Rate for Iteration 0 = ', 1-accuracy)

dot_data = tree.export_graphviz(treeFit,out_file=None,impurity = True, filled = True,feature_names = x_train.columns,class_names = ['0', '1'])
    
graph = graphviz.Source(dot_data)
graph

# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
# -------------------------------
